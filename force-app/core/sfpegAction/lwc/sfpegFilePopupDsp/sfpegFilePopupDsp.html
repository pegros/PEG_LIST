<template>
    <!-- Popup Header -->
    <lightning-modal-header label={modalHeader}>
    </lightning-modal-header>
    
    <lightning-modal-body>
        <!-- Main Popup Body -->
        <div class={modalClass}>
            <div class="slds-is-relative">
            <template lwc:if={modalMessage}>
                <p class="slds-p-horizontal_small slds-m-bottom_small">
                    <lightning-formatted-text class="slds-text-body_regular" value={modalMessage}></lightning-formatted-text>
                </p>
            </template>
            <template lwc:if={modalHelp}>
                <p class="slds-p-horizontal_small slds-m-bottom_small">
                    <lightning-formatted-text class="slds-text-body_small slds-text-color_weak" value={modalHelp}></lightning-formatted-text>
                </p>
            </template>

            <template lwc:if={allowMultiple}>
                <lightning-file-upload  label={uploadLabel}
                                        class="slds-align_absolute-center"
                                        accept={fileFormats}
                                        record-id={recordId}
                                        multiple
                                        onuploadfinished={handleUploadFinished}
                                        onclick={handleUploadStart} >
                </lightning-file-upload>
            </template>
            <template lwc:else>
                <lightning-file-upload  label={uploadLabel}
                                        class="slds-align_absolute-center"
                                        accept={fileFormats}
                                        record-id={recordId}
                                        onuploadfinished={handleUploadFinished}
                                        onclick={handleUploadStart} >
                </lightning-file-upload>
            </template>

            <template lwc:if={fileFormats}>
                <div class="slds-p-top_small slds-align_absolute-center">
                    <p class="slds-text-title slds-m-right_x-small">{formatsTitle}</p>
                    <div class="slds-grid slds-wrap">
                        <template for:each={fileFormats} for:item="eachItem">
                            <lightning-badge    label={eachItem}
                                                key={eachItem}
                                                class="slds-badge_inverse slds-m-vertical_xx-small">
                            </lightning-badge>
                        </template>
                    </div>
                </div>
            </template>

            <template lwc:if={showSpinner}>
                <lightning-spinner  alternative-text={spinnerMessage}  size="medium">
                </lightning-spinner>
            </template>
            </div>
        </div>

        <!-- Debug Information Display -->
        <template lwc:if={isDebug}>
            <div class="slds-text-align_left slds-p-around_small slds-m-top_small slds-border_top"  >
                <dl class="slds-dl_horizontal slds-text-align_left">
                    <dt class="slds-dl_horizontal__label slds-truncate">(aria-)label:</dt>
                    <dd class="slds-dl_horizontal__detail">{label}</dd>
                    <dt class="slds-dl_horizontal__label slds-truncate">(aria-)description:</dt>
                    <dd class="slds-dl_horizontal__detail">{description}</dd>
                    <dt class="slds-dl_horizontal__label slds-truncate">Documentation:</dt>
                    <dd class="slds-dl_horizontal__detail">
                        <lightning-formatted-url    value="https://github.com/pegros/PEG_LIST/blob/master/help/sfpegActionBarCmp.md"
                                                    label="See Help on GitHub"
                                                    target="_blank">
                        </lightning-formatted-url>
                    </dd>
                </dl>
            </div>
        </template>
    </lightning-modal-body>

    <!-- Popup Footer -->
    <lightning-modal-footer>
        <lightning-button   lwc:ref="cancelButton"
                            label={cancelLabel}     title={cancelTitle}
                            variant="neutral"   
                            onclick={handleCancel} >
        </lightning-button>
    </lightning-modal-footer>
</template>